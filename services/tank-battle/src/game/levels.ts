// Level definitions

import { TileType, MAP_WIDTH, MAP_HEIGHT } from './types';

// 0=Empty, 1=Brick, 2=Steel, 3=Water, 4=Forest, 5=Ice, 6=Base
// Simplified maps (26x26)

function parseLevel(str: string): TileType[][] {
  const lines = str.trim().split('\n');
  const map: TileType[][] = [];
  for (let y = 0; y < MAP_HEIGHT; y++) {
    const row: TileType[] = [];
    const line = lines[y] || '';
    for (let x = 0; x < MAP_WIDTH; x++) {
      const char = line[x] || '0';
      row.push(parseInt(char) as TileType);
    }
    map.push(row);
  }
  return map;
}

const LEVEL_1_STR = `
00000000000000000000000000
00000000000000000000000000
00110011001100110011001100
00110011001100110011001100
00110011001100110011001100
00110011002200110011001100
00110011002200110011001100
00000000000000000000000000
00000000000000000000000000
00110011001100110011001100
00110011001100110011001100
00110022220000222200110011
00110022220000222200110011
00000000000000000000000000
00000000000000000000000000
00110011001100110011001100
00110011001100110011001100
00000000002200000000000000
00000000002200000000000000
00110011000000001100110011
00110011000000001100110011
00000000001111110000000000
00000000001166110000000000
00000000001166110000000000
00000000001111110000000000
00000000000000000000000000
`.trim();

const LEVEL_2_STR = `
00000000000000000000000000
00333300003333000033330000
00333300003333000033330000
00000000000000000000000000
01100110022002200110011000
01100110022002200110011000
00000000000000000000000000
00444400004444000044440000
00444400004444000044440000
00000000000000000000000000
01100110011001100110011000
01100110011001100110011000
00000000000000000000000000
00555500005555000055550000
00555500005555000055550000
00000000000000000000000000
01100110022002200110011000
01100110022002200110011000
00000000000000000000000000
01100110011001100110011000
01100110011001100110011000
00000000001111110000000000
00000000001166110000000000
00000000001166110000000000
00000000001111110000000000
00000000000000000000000000
`.trim();

const LEVEL_3_STR = `
00000000000000000000000000
02200220022002200220022000
02200220022002200220022000
00000000000000000000000000
00110011001100110011001100
00110011001100110011001100
00003333333333333333330000
00003333333333333333330000
00000000000000000000000000
01100110022002200110011000
01100110022002200110011000
00000000000000000000000000
00444444444444444444440000
00444444444444444444440000
00000000000000000000000000
01100110022002200110011000
01100110022002200110011000
00000000000000000000000000
00555555555555555555550000
00555555555555555555550000
00110011001100110011001100
00000000001111110000000000
00000000001166110000000000
00000000001166110000000000
00000000001111110000000000
00000000000000000000000000
`.trim();

export const LEVELS: TileType[][][] = [
  parseLevel(LEVEL_1_STR),
  parseLevel(LEVEL_2_STR),
  parseLevel(LEVEL_3_STR),
];

export interface EnemySpawn {
  x: number;
  y: number;
  type: 'normal' | 'light' | 'heavy' | 'rapid';
  delay: number;
}

export const LEVEL_ENEMIES: EnemySpawn[][] = [
  // Level 1: 20 enemies
  [
    { x: 0, y: 0, type: 'normal', delay: 0 },
    { x: 12, y: 0, type: 'normal', delay: 3000 },
    { x: 24, y: 0, type: 'normal', delay: 6000 },
    { x: 0, y: 0, type: 'light', delay: 10000 },
    { x: 24, y: 0, type: 'light', delay: 14000 },
    { x: 12, y: 0, type: 'normal', delay: 18000 },
    { x: 0, y: 0, type: 'heavy', delay: 22000 },
    { x: 24, y: 0, type: 'normal', delay: 26000 },
    { x: 12, y: 0, type: 'light', delay: 30000 },
    { x: 0, y: 0, type: 'rapid', delay: 35000 },
  ],
  // Level 2
  [
    { x: 0, y: 0, type: 'light', delay: 0 },
    { x: 24, y: 0, type: 'light', delay: 2000 },
    { x: 12, y: 0, type: 'normal', delay: 5000 },
    { x: 0, y: 0, type: 'heavy', delay: 8000 },
    { x: 24, y: 0, type: 'rapid', delay: 12000 },
    { x: 12, y: 0, type: 'light', delay: 16000 },
    { x: 0, y: 0, type: 'heavy', delay: 20000 },
    { x: 24, y: 0, type: 'heavy', delay: 25000 },
    { x: 12, y: 0, type: 'rapid', delay: 30000 },
    { x: 0, y: 0, type: 'rapid', delay: 35000 },
  ],
  // Level 3
  [
    { x: 0, y: 0, type: 'heavy', delay: 0 },
    { x: 24, y: 0, type: 'heavy', delay: 3000 },
    { x: 12, y: 0, type: 'rapid', delay: 6000 },
    { x: 0, y: 0, type: 'rapid', delay: 9000 },
    { x: 24, y: 0, type: 'light', delay: 12000 },
    { x: 12, y: 0, type: 'heavy', delay: 16000 },
    { x: 0, y: 0, type: 'rapid', delay: 20000 },
    { x: 24, y: 0, type: 'rapid', delay: 24000 },
    { x: 12, y: 0, type: 'heavy', delay: 28000 },
    { x: 0, y: 0, type: 'heavy', delay: 33000 },
  ],
];

export function getPlayerSpawn(): { x: number; y: number } {
  return { x: 8, y: 24 };
}
