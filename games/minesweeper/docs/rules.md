# 扫雷 Minesweeper 详细规则与玩法（开发者友好版）

> 本文既是“玩家说明书”，也是你作为开发者验证逻辑正确性的清单。

---

## 1. 游戏目标（一句话）

在不踩到任何地雷的前提下，**翻开所有“非雷格子”** 即获胜。

---

## 2. 棋盘与元素

棋盘由很多“格子”组成，每个格子处于以下状态之一：

- **未翻开**：默认状态（看起来是凸起的按钮）
- **已翻开**：
  - **空白**：周围 8 格没有雷，会自动连锁展开
  - **数字 1~8**：表示它周围 8 格里有多少个地雷
- **旗帜（🚩）**：你怀疑这里有雷，可以插旗标记
- **地雷（💣）**：翻到就失败（踩中的那一格会显示 💥）

---

## 3. 数字规则（核心）

当一个格子被翻开显示数字 `N` 时：

- 它周围（最多 8 个相邻格，包括斜对角）**恰好有 N 个地雷**
- 相邻格包含：
  - 上、下、左、右
  - 左上、右上、左下、右下

举例：  
如果某格显示 `3`，说明它周围 8 格中有 **3 个是雷**，其余 **5 个不是雷**。

---

## 4. 你的操作

### 4.1 桌面端（鼠标 + 键盘）

#### 鼠标
- **左键**：翻开格子  
- **右键**：插旗 / 取消旗  
- **双击数字格**：执行“快速翻开周围”（见第 5 节）

#### 键盘（强烈推荐）
- **方向键**：移动焦点（哪个格子会被操作）
- **空格**：翻开焦点格
- **F**：对焦点格插旗 / 取消旗
- **Enter**：对焦点格执行“快速翻开周围”

> 可访问性说明：每个格子都是可聚焦按钮（button），屏幕阅读器会读出格子状态。

---

### 4.2 手机端（触屏）

手机没有右键，因此提供两种等价操作（你可以任选其一）：

#### 方式 A：模式按钮（推荐新手）
棋盘上方有三种模式：

- **翻开**：点格子 = 翻开
- **插旗**：点格子 = 插旗/取消旗
- **快速翻开**：点数字格 = 快速翻开周围

#### 方式 B：长按插旗（更接近电脑）
- **短按**：翻开  
- **长按**（约 0.4 秒）：插旗/取消旗

> 你也可以搭配“全屏”按钮减少浏览器地址栏遮挡（若浏览器支持会尽力锁定竖屏）。

---

## 5. “快速翻开周围”（Chord / Quick Open）规则

这是扫雷效率最高的技巧。

当你翻开一个数字格 `N` 之后：

1. 你在它周围插旗（🚩）标记你认为是雷的格子
2. **如果周围旗帜数量 == N**  
3. 那么对这个数字格执行“快速翻开”（桌面双击 / 键盘 Enter / 手机切换到“快速翻开”模式点击）：
   - 系统会**自动翻开周围所有“未翻开且未插旗”的格子**

⚠️ 重要：如果你插的旗不正确（比如少插/多插/插错位置），快速翻开可能会直接翻到雷导致失败。  
这是扫雷中最刺激也最容易翻车的一步。

---

## 6. 首次点击必不踩雷（本项目的特别规则）

本项目实现了经典扫雷体验优化：

- **第一次翻开绝不会是地雷**
- 并且尽量保证第一次点击附近更容易展开：
  - 会优先保证第一次点击的 **3×3 区域（最多 9 格）没有雷**
  - 这样第一次点击通常会开出一片空白

---

## 7. 计时器与剩余雷数是什么意思？

### 计时器
- 从你**第一次成功翻开**开始计时
- 胜利/失败后停止

### 剩余雷数
- 计算方式：`总雷数 - 已插旗数量`
- 它不是“系统告诉你还有多少真雷”，只是“你还可以插多少旗”的提示

---

## 8. 胜利/失败判定（如何结束一局）

### 胜利（Win）
满足以下条件即胜利：

- **所有非雷格子都被翻开**（不要求你把所有雷都插旗）

### 失败（Lose）
只要发生：

- 翻开到任意一个地雷格（💣） -> 立即失败（显示 💥）

---

## 9. 实战小技巧（对新手很有用）

- 优先从空白区域扩张，减少“纯猜”
- 数字 `1` 附近通常是最安全的推理起点
- 当你确定某格是雷时再插旗：旗是“标记”，不是“必要步骤”
- 不要依赖“剩余雷数”来判断是否正确，它只和旗数量有关
- 慎用“快速翻开”，确保周围旗帜数量真的等于数字

---

## 10. 开发者验证清单（你可以对照测试）

- 数字是否等于周围雷数量（含对角）
- 空白展开是否正确（BFS/递归）
- 首次点击是否永远安全，且尽量开出空白
- 快速翻开：只有当周围旗帜数量 == 数字时才触发
- 胜利条件：所有非雷已翻开即胜利（与插旗无关）
- 手机端：短按/长按/模式切换是否互不冲突
