/* Retro 2048 â€” pure CSS, two themes via CSS variables
   Note: "Windows-ish" bevels + modern flat touches. */

:root {
  --radius: 18px;
  --radius-sm: 12px;
  --gap: 10px;
  --shadow: 0 10px 30px rgba(0,0,0,.18);
  --bevel-hi: rgba(255,255,255,.65);
  --bevel-lo: rgba(0,0,0,.25);
  --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "PingFang SC", "Noto Sans CJK SC", "Microsoft YaHei", Arial, sans-serif;

  /* will be overwritten by theme blocks */
  --bg: #f2f2f2;
  --panel: #fbfbfb;
  --panel2: #f0f0f0;
  --text: #1b1b1b;
  --muted: rgba(0,0,0,.6);
  --border: rgba(0,0,0,.18);
  --board: #d7d0c3;
  --cell: rgba(0,0,0,.08);
  --btn: #f7f7f7;
  --btnText: #1b1b1b;
  --btnBorder: rgba(0,0,0,.22);
  --accent: #2b6fff;
}

html[data-theme="light"] {
  --bg: #f2f2f2;
  --panel: #fbfbfb;
  --panel2: #f0f0f0;
  --text: #1b1b1b;
  --muted: rgba(0,0,0,.6);
  --border: rgba(0,0,0,.18);
  --board: #d7d0c3;
  --cell: rgba(0,0,0,.08);
  --btn: #f7f7f7;
  --btnText: #1b1b1b;
  --btnBorder: rgba(0,0,0,.22);
  --accent: #2b6fff;
}

html[data-theme="dark"] {
  --bg: #0f1114;
  --panel: #171a20;
  --panel2: #12151a;
  --text: #f3f5f7;
  --muted: rgba(255,255,255,.65);
  --border: rgba(255,255,255,.14);
  --board: #2a2e36;
  --cell: rgba(255,255,255,.08);
  --btn: #1f2430;
  --btnText: #f3f5f7;
  --btnBorder: rgba(255,255,255,.16);
  --accent: #6aa7ff;
}

* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  font-family: var(--font);
  color: var(--text);
  background:
    radial-gradient(1200px 500px at 20% 0%, rgba(43,111,255,.16), transparent 60%),
    radial-gradient(900px 500px at 80% 20%, rgba(255,168,64,.12), transparent 55%),
    linear-gradient(180deg, var(--bg), var(--bg));
  -webkit-tap-highlight-color: transparent;
}

.app{
  min-height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 18px 14px 26px;
  gap: 14px;
}

.topbar{
  width: min(96vw, 520px);
  background: linear-gradient(180deg, var(--panel), var(--panel2));
  border: 1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding: 14px 14px 12px;
  display: flex;
  align-items: flex-end;
  justify-content: space-between;
  gap: 10px;
}

.title-block{
  display: flex;
  flex-direction: column;
  gap: 6px;
}
.title{
  margin: 0;
  font-size: 36px;
  letter-spacing: .5px;
  line-height: 1;
  text-shadow: 0 1px 0 var(--bevel-hi);
}
.subtitle{
  font-size: 12.5px;
  color: var(--muted);
}

.hud{
  display: flex;
  gap: 10px;
}
.scorebox{
  min-width: 92px;
  padding: 8px 10px;
  border-radius: 14px;
  background: linear-gradient(180deg, rgba(255,255,255,.35), rgba(0,0,0,.06));
  border: 1px solid var(--border);
  box-shadow:
    inset 0 1px 0 var(--bevel-hi),
    inset 0 -1px 0 var(--bevel-lo);
}
html[data-theme="dark"] .scorebox{
  background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(0,0,0,.22));
}
.scorebox .label{
  font-size: 11px;
  letter-spacing: 1.2px;
  color: var(--muted);
}
.scorebox .value{
  font-size: 22px;
  font-weight: 700;
}

.controls{
  width: min(96vw, 520px);
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}

.btn{
  appearance: none;
  border: 1px solid var(--btnBorder);
  color: var(--btnText);
  background: linear-gradient(180deg, rgba(255,255,255,.55), rgba(0,0,0,.04)), var(--btn);
  border-radius: 14px;
  padding: 11px 12px;
  font-size: 14px;
  font-weight: 650;
  cursor: pointer;
  box-shadow:
    0 3px 0 rgba(0,0,0,.18),
    inset 0 1px 0 var(--bevel-hi),
    inset 0 -1px 0 var(--bevel-lo);
  user-select: none;
  touch-action: manipulation;
  transition: transform .06s ease, filter .15s ease;
}
.btn:active{
  transform: translateY(1px);
  filter: brightness(.98);
}
.btn:disabled{
  opacity: .55;
  cursor: not-allowed;
  transform: none;
}
.btn.primary{
  border-color: color-mix(in srgb, var(--accent) 60%, var(--btnBorder));
  background:
    linear-gradient(180deg, rgba(255,255,255,.55), rgba(0,0,0,.06)),
    linear-gradient(180deg, color-mix(in srgb, var(--accent) 28%, var(--btn)), var(--btn));
}

.game{
  width: min(96vw, 520px);
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
}

.board-wrap{
  width: min(92vw, 520px);
  display: flex;
  justify-content: center;
}

.board{
  width: min(92vw, 440px);
  aspect-ratio: 1 / 1;
  background: linear-gradient(180deg, rgba(255,255,255,.35), rgba(0,0,0,.08)), var(--board);
  border-radius: calc(var(--radius) + 4px);
  border: 1px solid var(--border);
  box-shadow:
    var(--shadow),
    inset 0 1px 0 var(--bevel-hi),
    inset 0 -1px 0 var(--bevel-lo);
  position: relative;
  padding: var(--gap);
  outline: none;
  touch-action: none; /* we implement our own swipe */
}

.grid{
  position: absolute;
  inset: var(--gap);
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  grid-template-rows: repeat(4, 1fr);
  gap: var(--gap);
}

.cell{
  border-radius: var(--radius-sm);
  background: var(--cell);
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.35),
    inset 0 -1px 0 rgba(0,0,0,.12);
}

.tiles{
  position: absolute;
  inset: var(--gap);
}

.tile{
  position: absolute;
  border-radius: var(--radius-sm);
  display: grid;
  place-items: center;
  font-weight: 800;
  user-select: none;
  transform: translate(0px, 0px);
  transition: transform 120ms cubic-bezier(.2,.85,.25,1);
  box-shadow:
    0 8px 18px rgba(0,0,0,.15),
    inset 0 1px 0 rgba(255,255,255,.5),
    inset 0 -1px 0 rgba(0,0,0,.15);
  border: 1px solid rgba(0,0,0,.12);
}

html[data-theme="dark"] .tile{
  border-color: rgba(255,255,255,.10);
  box-shadow:
    0 10px 24px rgba(0,0,0,.50),
    inset 0 1px 0 rgba(255,255,255,.16),
    inset 0 -1px 0 rgba(0,0,0,.28);
}

.tile .num{
  text-shadow: 0 1px 0 rgba(255,255,255,.35);
}

.tile.new{
  animation: pop-in 150ms ease-out both;
}

.tile.merged{
  animation: pop-merge 160ms ease-out both;
}

@keyframes pop-in {
  from { transform: translate(var(--tx), var(--ty)) scale(.25); }
  to   { transform: translate(var(--tx), var(--ty)) scale(1); }
}
@keyframes pop-merge {
  0%   { transform: translate(var(--tx), var(--ty)) scale(1); }
  60%  { transform: translate(var(--tx), var(--ty)) scale(1.12); }
  100% { transform: translate(var(--tx), var(--ty)) scale(1); }
}

.tips{
  width: 100%;
  text-align: center;
  font-size: 12.5px;
  color: var(--muted);
  line-height: 1.4;
}

.footer{
  margin-top: auto;
  width: min(96vw, 520px);
  text-align: center;
  color: var(--muted);
  font-size: 12px;
}

/* Modal (Windows-like titlebar) */
.modal{
  position: fixed;
  inset: 0;
  display: grid;
  place-items: center;
  padding: 18px;
  background: rgba(0,0,0,.35);
  z-index: 50;
}
.modal.hidden{ display: none; }

.modal-window{
  width: min(92vw, 420px);
  background: linear-gradient(180deg, var(--panel), var(--panel2));
  border: 1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: 0 30px 70px rgba(0,0,0,.35);
  overflow: hidden;
}

.modal-titlebar{
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  padding: 10px 12px;
  border-bottom: 1px solid var(--border);
  background:
    linear-gradient(90deg, color-mix(in srgb, var(--accent) 30%, var(--panel)), var(--panel));
}

.modal-title{
  font-weight: 800;
  letter-spacing: .4px;
}
.win-btn{
  border: 1px solid var(--btnBorder);
  background: var(--btn);
  color: var(--btnText);
  width: 34px;
  height: 30px;
  border-radius: 10px;
  cursor: pointer;
  box-shadow:
    inset 0 1px 0 var(--bevel-hi),
    inset 0 -1px 0 var(--bevel-lo);
}
.modal-body{
  padding: 14px 14px 6px;
  color: var(--text);
  line-height: 1.55;
}
.modal-actions{
  padding: 10px 14px 14px;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}

@media (min-width: 480px){
  .title{ font-size: 44px; }
  .controls{ grid-template-columns: 1.2fr 1fr 1fr 1fr; }
}

@media (prefers-reduced-motion: reduce){
  .tile{ transition: none; }
  .tile.new, .tile.merged{ animation: none; }
  .btn{ transition: none; }
}

/* Tile colors (value -> background). Kept compact; works in both themes. */
.tile[data-v="2"]    { background: #eee4da; color: #3f3a32; }
.tile[data-v="4"]    { background: #ede0c8; color: #3f3a32; }
.tile[data-v="8"]    { background: #f2b179; color: #fff7ef; }
.tile[data-v="16"]   { background: #f59563; color: #fff7ef; }
.tile[data-v="32"]   { background: #f67c5f; color: #fff7ef; }
.tile[data-v="64"]   { background: #f65e3b; color: #fff7ef; }
.tile[data-v="128"]  { background: #edcf72; color: #3f3a32; }
.tile[data-v="256"]  { background: #edcc61; color: #3f3a32; }
.tile[data-v="512"]  { background: #edc850; color: #3f3a32; }
.tile[data-v="1024"] { background: #edc53f; color: #3f3a32; }
.tile[data-v="2048"] { background: #edc22e; color: #3f3a32; }

html[data-theme="dark"] .tile[data-v="2"]    { background: #3a3b43; color: #f3f5f7; }
html[data-theme="dark"] .tile[data-v="4"]    { background: #45485a; color: #f3f5f7; }
html[data-theme="dark"] .tile[data-v="8"]    { background: #2c79ff; color: #f7fbff; }
html[data-theme="dark"] .tile[data-v="16"]   { background: #2e59ff; color: #f7fbff; }
html[data-theme="dark"] .tile[data-v="32"]   { background: #674cff; color: #f7fbff; }
html[data-theme="dark"] .tile[data-v="64"]   { background: #a34cff; color: #f7fbff; }
html[data-theme="dark"] .tile[data-v="128"]  { background: #ffb020; color: #15171a; }
html[data-theme="dark"] .tile[data-v="256"]  { background: #ff9800; color: #15171a; }
html[data-theme="dark"] .tile[data-v="512"]  { background: #ff7a00; color: #15171a; }
html[data-theme="dark"] .tile[data-v="1024"] { background: #ff5f00; color: #15171a; }
html[data-theme="dark"] .tile[data-v="2048"] { background: #ffdd3b; color: #15171a; }

.tile[data-v="128"] .num,
.tile[data-v="256"] .num,
.tile[data-v="512"] .num,
.tile[data-v="1024"] .num,
.tile[data-v="2048"] .num{
  font-size: 28px;
}

@media (max-width: 380px){
  .tile .num{ font-size: 30px; }
  .tile[data-v="128"] .num,
  .tile[data-v="256"] .num,
  .tile[data-v="512"] .num,
  .tile[data-v="1024"] .num,
  .tile[data-v="2048"] .num{
    font-size: 24px;
  }
}
